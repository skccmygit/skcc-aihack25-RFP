# 연동 API 관리 화면 (INT-SCR-001)
## 사용 역할자 : 시스템 관리자
## 관련 메뉴 : 관리자 시스템 > 시스템 관리 > 연동 관리 > API 관리
---
## 기능 1: 제공 API 목록 조회

- 관련 요구사항: INT-REQ-001 ~ INT-REQ-005 (제공 API 목록 확인 및 관리)
- 입력 정보:
    - 검색 조건: API명, API 엔드포인트, 연동 대상 시스템, 상태(활성/비활성).
    - '검색' 버튼, 페이지네이션, 정렬.
- 출력 정보:
    - **제공 API 목록 테이블:**
        - 컬럼: 번호(No), API명, HTTP 메서드, 엔드포인트(URL), 연동 대상 시스템, 설명, 상태(활성/비활성), 최근 호출 일시.
    - 각 행 클릭 시 상세 정보 및 설정 수정 기능 제공 가능.
- 프로세스 설명: 본 시스템이 외부 시스템(예: 스포츠지원포털)에 제공하는 API들의 목록과 기본 정보를 관리자가 확인하는 화면. (API 자체는 백엔드에 구현됨)
- 호출 API 정보: (시스템 내부 관리용 API) `GET /api/v1/admin/integration/apis/provided`

---
## 기능 2: API 상세 정보 조회 및 설정 수정 (제한적)

- 관련 요구사항: 제공 API 관리
- 입력 정보: (목록에서 API 클릭 시)
    - **API 기본 정보:** API명, 메서드, 엔드포인트, 설명 (대부분 읽기 전용, 설명 등 일부 수정 가능).
    - **연동 대상 시스템 정보:** 대상 시스템 이름, 담당자 연락처 등 메모.
    - **API 상태:** 스위치 (활성/비활성). API 호출 허용 여부 제어.
    - **(선택적) 접근 제어 설정:** API Key 발급/관리, IP 접근 제한 설정 등.
    - **'저장' 버튼**.
- 출력 정보: 저장 성공/실패 메시지.
- 프로세스 설명: 특정 제공 API의 상태(활성/비활성)를 변경하거나 관련 메모, 접근 제어 설정을 관리. API 자체의 로직 수정은 코드 레벨에서 이루어짐.
- 호출 API 정보: `GET /api/v1/admin/integration/apis/provided/{apiId}`, `PUT /api/v1/admin/integration/apis/provided/{apiId}`

---

# 연동 로그 조회 화면 (INT-SCR-002)
## 사용 역할자 : 시스템 관리자
## 관련 메뉴 : 관리자 시스템 > 시스템 관리 > 연동 관리 > 연동 로그 조회
---
## 기능 1: API 호출/수신 로그 조회

- 관련 요구사항: INT-REQ-006 ~ INT-REQ-009 (실제 연동 처리 시 발생하는 로그 확인 목적)
- 입력 정보:
    - **로그 유형 선택:** 라디오 버튼 (제공 API 호출 로그 / 외부 API 호출 로그 / 데이터 수신 로그).
    - **검색 조건:**
        - 기간: 날짜/시간 범위 선택.
        - API명/엔드포인트: 텍스트 필드.
        - 연동 대상 시스템: 텍스트 필드.
        - 처리 상태: Select 박스 (전체, 성공, 실패).
        - 관련 데이터 식별자 (예: 사용자 ID, 수료증 ID).
    - **'검색' 버튼**, **페이지네이션**, **정렬**.
- 출력 정보:
    - **연동 로그 목록 테이블:**
        - 컬럼: 로그 ID, 발생 일시, 로그 유형, API명/엔드포인트, 연동 대상 시스템, 요청 데이터(요약 또는 클릭 시 상세), 응답 데이터(요약 또는 클릭 시 상세), 처리 상태, 처리 시간(ms).
    - 각 행 클릭 시 상세 로그 팝업 표시 (기능 2).
- 프로세스 설명: 외부 시스템과 API를 통해 데이터를 주고받은 기록(로그)을 관리자가 조회하여 연동 상태를 모니터링하고 오류 발생 시 원인을 파악. 백엔드에서 연동 시 발생하는 상세 로그(요청/응답 전문 포함)를 DB 또는 로그 파일 시스템에 기록해야 함.
- 호출 API 정보: `GET /api/v1/admin/integration/logs` (파라미터: logType, startDate, endDate, apiName, status 등)

---
## 기능 2: 상세 로그 정보 조회

- 관련 요구사항: 연동 오류 분석 및 디버깅
- 입력 정보: 목록에서 특정 로그 행 클릭.
- 출력 정보:
    - **상세 로그 팝업:**
        - 로그 기본 정보 (일시, API, 상태 등).
        - **전체 요청 전문:** (필요시 포맷팅되어 표시).
        - **전체 응답 전문:** (필요시 포맷팅되어 표시).
        - 오류 발생 시 상세 오류 메시지 및 스택 트레이스(필요시).
    - '닫기' 버튼.
- 프로세스 설명: 선택된 연동 로그의 상세 내용을 확인. 민감 정보(API Key, 개인 정보 등)는 마스킹 처리될 수 있음.
- 호출 API 정보: `GET /api/v1/admin/integration/logs/{logId}`

---
### 예외 처리 및 유의 사항

- **로깅 수준:** 어떤 내용을 로그로 남길지(요청/응답 헤더, 바디 전체 또는 일부 등) 정책 정의 필요. 너무 상세하면 성능 부하 및 저장 공간 문제가 발생할 수 있음.
- **로그 보관:** 로그 데이터 보관 주기 및 백업/삭제 정책 수립 필요.
- **오류 알림:** 연동 실패 시 관리자에게 알림(메일, SMS 등)을 보내는 기능 연동 고려.

---

# 외부 시스템 연동 설정 화면 (INT-SCR-003)
## 사용 역할자 : 시스템 관리자
## 관련 메뉴 : 관리자 시스템 > 시스템 관리 > 연동 관리 > 연동 설정
---
## 기능 1: 연동 대상 시스템 정보 및 설정 관리

- 관련 요구사항: INT-REQ-006 ~ INT-REQ-009 (연동 대상 시스템과의 설정값 관리)
- 입력 정보:
    - **연동 대상 시스템 목록:** 테이블 또는 리스트 (예: 스포츠지원포털, PG사, SMS 서비스, 본인 인증 서비스, 지도 API 등).
    - 각 시스템 클릭 시 해당 시스템과의 연동 설정 폼 표시.
    - **설정 폼 항목 예시:** (시스템별 상이)
        - **스포츠지원포털:** API 엔드포인트 URL, 인증키(API Key), 타임아웃 설정.
        - **PG사:** 가맹점 ID, API Key, 결제 완료 콜백 URL, 취소 결과 수신 설정.
        - **SMS 서비스:** 서비스 URL, 계정 ID, API Key, 발신 번호.
        - **본인 인증 서비스:** 서비스 코드, 비밀번호, 결과 수신 URL.
    - **'저장' 버튼**.
- 출력 정보:
    - 현재 설정된 연동 정보 표시.
    - 저장 성공/실패 메시지.
- 프로세스 설명: 외부 시스템과의 연동에 필요한 설정값(API 주소, 인증 정보 등)을 관리자가 UI를 통해 설정하고 관리. 이 설정값들은 실제 백엔드 연동 로직에서 사용됨.
- 호출 API 정보: (시스템 내부 관리용 API)
    - 조회: `GET /api/v1/admin/integration/settings/{systemCode}`
    - 수정: `PUT /api/v1/admin/integration/settings/{systemCode}`

---
### 예외 처리 및 유의 사항

- **보안:** API Key, 비밀번호 등 민감 정보는 암호화하여 저장하고, 화면 표시 시 마스킹 처리해야 함. 접근 권한 관리 철저.
- **설정 변경 영향:** 연동 설정 변경 시 시스템 동작에 즉시 영향을 미치므로, 변경 전 테스트 및 영향도 분석 필요.
- **표준화:** 각 외부 시스템 연동 방식 및 설정 항목이 다르므로, 유연하게 관리할 수 있는 구조 설계.
